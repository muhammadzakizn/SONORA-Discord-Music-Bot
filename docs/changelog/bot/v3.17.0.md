# Bot Changelog v3.17.0 - Cleanup and Storage Optimization

**Release Date:** 2025-12-19

## Changes

### YouTube Music Search Matching Improvement
Memperbaiki masalah dimana pencarian lagu mengembalikan lagu yang salah dari artis yang sama.

**Sebelumnya:** Mengambil hasil pertama tanpa verifikasi
**Sesudah:** Mengambil 5 hasil dan memilih yang paling cocok berdasarkan kemiripan judul

**Algoritma baru:**
- Fetch 5 hasil dari YouTube Music
- Normalisasi judul (lowercase, hapus special chars)
- Hitung similarity score untuk setiap hasil
- Bonus score jika artis cocok
- Pilih hasil dengan score tertinggi (min 0.5)

**Files yang diupdate:**
- `services/audio/apple_music_handler.py` - Improved `_search_ytmusic()` with title matching

---

### FTP Failure Cleanup
Jika FTP upload gagal atau tidak available, file yang sudah didownload akan otomatis dihapus untuk menghemat disk space.

**Files yang diupdate:**
- `services/audio/playlist_cache.py` - Delete file on FTP failure
- `services/audio/youtube.py` - Delete file on FTP failure

### Startup Cache Cleanup
Bot akan membersihkan cache audio setiap kali startup untuk menghemat ruang disk.

**Cleanup includes:**
- `downloads/*.opus, *.m4a, *.mp3, *.webm, *.flac, *.ogg`
- `downloads/playlist_cache/*`

**Log output:**
```
ðŸ§¹ Startup cleanup: Deleted 5 files (23.4MB)
```

### Files Modified
- `core/bot.py` - Added `_startup_cleanup()` method
- `services/audio/playlist_cache.py` - Added `_delete_file_if_exists()`
- `services/audio/youtube.py` - Added `_delete_file_if_exists()`
- `services/audio/apple_music_handler.py` - Improved search matching
