# Bot Changelog v3.6.0 - Multi-Platform Audio Support

**Release Date:** 2025-12-16

## New Features

### TIDAL Integration
- Added TIDAL URL detection and processing (`tidal.com/browse/track|album|playlist`)
- TIDAL tracks fallback to YouTube Music search when MusicDL unavailable
- URL validators for TIDAL track, album, and playlist patterns

### SoundCloud Integration
- Full SoundCloud support via native yt-dlp
- Support for single tracks and sets/playlists
- Automatic metadata extraction from SoundCloud

### MusicDL Fallback System
- Created `services/audio/musicdl_handler.py` for multi-platform support
- Supports TIDAL, SoundCloud, and other platforms as fallback
- Graceful degradation when MusicDL not available

### WhisperLRC Auto-Lyrics
- Created `services/lyrics/whisper_lyrics.py` for AI-generated lyrics
- Uses faster-whisper for speech-to-text transcription
- Generates synced LRC format lyrics from audio files
- Disabled by default (set `ENABLE_WHISPER_LYRICS=true` to enable)

### Lyrics Priority Update
- New lyrics chain: LRCLIB -> Syncedlyrics -> WhisperLRC -> Genius (plain)
- WhisperLRC provides synced lyrics when no online source available

## Technical Changes

### URL Validators (`utils/validators.py`)
- Added `is_tidal_url()` and `is_soundcloud_url()` methods
- Added TIDAL and SoundCloud URL patterns
- Updated `get_url_type()` to return 'tidal' and 'soundcloud'

### Playlist Processor (`services/audio/playlist_processor.py`)
- Added `_process_tidal_url()` method
- Added `_process_soundcloud_url()` method
- SoundCloud sets/playlists parsed via yt-dlp flat-playlist

### Metadata Processor (`services/metadata/processor.py`)
- Integrated WhisperLRC as Priority 3 fallback
- Only activates when `ENABLE_WHISPER_LYRICS=true`

### Dependencies
- Added `musicdl>=2.7.0` to requirements.txt
- Added `faster-whisper>=1.0.0` to requirements.txt

## Known Issues
- MusicDL requires `rich>=13.9.4` but SONORA has `rich==11.0.0`
- For full HiFi TIDAL support, upgrade rich library or wait for musicdl update
- Current workaround: TIDAL falls back to YouTube Music search
