# SONORA v3.24.0 - Lyricify Integration (QQ Music Syllable Lyrics)

**Release Date:** 2025-12-22

## Bot Changes

### LyricifyApi C# Microservice

#### New Microservice
- **LyricifyApi**: C# .NET 9.0 Web API that wraps Lyricify-Lyrics-Helper library
- **QQ Music Integration**: Get syllable-timed lyrics from QQ Music (QRC format)
- **Multi-source Search**: Search across QQ Music, Netease, and Kugou
- **Auto-start**: Launcher automatically starts LyricifyApi on port 5050

#### Endpoints
- `GET /api/lyrics/search` - Search songs across all sources
- `GET /api/lyrics/qqmusic/{songId}` - Get QQ Music lyrics by ID
- `GET /api/lyrics/netease/{songId}` - Get Netease lyrics by ID
- `GET /api/lyrics/kugou/{songHash}` - Get Kugou lyrics by hash
- `GET /api/lyrics/auto` - Auto search and fetch lyrics

### Python Client
- **LyricifyClient**: Python wrapper for LyricifyApi (`services/lyrics/lyricify_client.py`)
- **Health check**: Automatic availability detection
- **QRC parsing**: Converts QRC syllable timing to LyricsData format

### Config Updates
- Added `LYRICIFY` to `LyricsSource` enum in `config/constants.py`
- Launcher config: `LYRICIFY_API_PORT = 5050`

---

## Web Changes

### Fullscreen Lyrics Player

#### New Source Option
- **Lyricify (QQ)**: Added as lyrics source option in settings panel
- Syllable-level timing for karaoke-style word highlighting
- Same UI treatment as Apple Music, Musixmatch, etc.

#### Improved Source Selection
- Sources now ordered: Apple Music, Lyricify, Musixmatch, LRCLIB, Auto
- Clear labeling: "Lyricify (QQ)" indicates QQ Music source

### Backend Integration
- Flask `/api/guild/{guild_id}/lyrics` now supports `source=lyricify`
- Lyricify lyrics cached server-side (10 min TTL)
- `available_sources` response includes lyricify

---

## Technical Details

### Files Added
- `LyricifyApi/` - C# microservice project
  - `Controllers/LyricsController.cs`
  - `Services/LyricsService.cs`
  - `Models/LyricsModels.cs`
  - `Program.cs`
- `services/lyrics/lyricify_client.py` - Python client

### Files Modified
- `launcher.py` - Auto-start LyricifyApi
- `config/constants.py` - LYRICIFY enum
- `web/api/app.py` - Lyricify source handler
- `web/src/components/lyrics/FullscreenLyricsPlayer.tsx` - UI updates

---

## Requirements
- **.NET 9.0 Runtime** for LyricifyApi (optional - lyrics still work without it)
- LyricifyApi must be built: `cd LyricifyApi && dotnet build`

## Previous Version
- v3.23.0
